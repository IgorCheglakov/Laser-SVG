# AI Coding Agent: General Requirements & Guidelines

Этот документ описывает обязательные стандарты работы ИИ-агента при написании кода. Данные требования применяются ко всем проектам независимо от стека технологий, языка программирования или предметной области.

## 1. Качество кода и стиль

### 1.1. Комментирование
- **Язык:** Все комментарии в коде должны быть написаны на **английском языке**.
- **Обязательность:** Каждая функция (метод) и каждый класс должны иметь как минимум один краткий однострочный комментарий, описывающий их назначение.
- **Содержание:** Комментарии должны объяснять *почему* сделано именно так, а не дублировать очевидную логику кода (*what*). Избегать избыточных комментариев для тривиальных геттеров/сеттеров.
- **Пример:**
  ```python
  # Calculates total price including tax based on user region
  def calculate_total(price, region):


## 1.2. Именование
**Читаемость:** Все переменные, функции, классы и модули должны иметь "говорящие" названия (self-descriptive names).
**Запрет:** Избегать однобуквенных имен (кроме счетчиков циклов i, j в простых конструкциях) и аббревиатур, не являющихся общепринятыми в данном языке.
**Стиль:** Соблюдать идиоматический стиль именования для выбранного языка (например, snake_case для Python, camelCase для JavaScript).

## 2. Управление проектом и структурой

### 2.1. Файл PROJECT-STRUCTURE.md
- **Инициализация:** При начале работы над новым проектом (если в рабочей папке отсутствуют файлы кода, созданные ИИ), **первым действием** является создание файла `PROJECT-STRUCTURE.md`.
- **Содержание файла:**
  - Древовидная структура модулей и файлов (желательно с использованием псевдографики/ASCII).
  - Описание общей архитектуры и бизнес-логики.
  - Особенности реализации и ключевые зависимости.
- **Поддержание актуальности:**
  - В начале каждой новой сессии агент обязан ознакомиться с этим файлом.
  - Любые изменения в структуре проекта (добавление/удаление модулей, смена архитектуры) должны быть **сначала** отражены в `PROJECT-STRUCTURE.md`, и только после этого реализованы в коде.

### 2.2. Поэтапная разработка (Staged Development)
- Проект реализуется строго по стадиям, указанным в спецификации.
- **Процесс тестирования стадии:**
  1. Агент реализует код текущей стадии.
  2. Пользователь вручную тестирует результат.
  3. Если тестирование успешно — пользователь дает команду на создание коммита.
  4. Если найдены ошибки — пользователь указывает на них, агент исправляет код без создания коммита.
- Не переходить к следующей стадии, пока не подтверждена работоспособность текущей.

### 2.3. Управление зависимостями
- Все внешние библиотеки и пакеты должны быть явно указаны в соответствующих файлах манифеста (`requirements.txt`, `package.json`, `Cargo.toml` и т.д.).
- Перед добавлением новой зависимости, которая не была заранее оговорена в спецификации, агент должен запросить разрешение у пользователя.

### 2.4. Работа с контекстом файлов
- Перед внесением изменений в любой существующий файл агент обязан прочитать его актуальное содержимое.
- Это необходимо для предотвращения конфликтов, потери логики и обеспечения согласованности кода, особенно если контекст сессии был частично очищен.

## 3. Контроль версий (Git)

- **Запрет действий:** Агенту **строго запрещено** выполнять команды `git add`, `git commit`, `git push` или любые другие команды записи в историю Git без явного запроса и подтверждения от пользователя.
- **Причина:** Пользователь должен самостоятельно контролировать точки сохранения и сообщения коммитов.
- **Откат изменений (Rollback):** Если в процессе разработки возникает критическая ошибка, которую нельзя быстро исправить, или если новые изменения ломают существующую функциональность, агент должен помочь пользователю откатить изменения к последней рабочей версии (например, подсказать команды `git checkout` или `git revert`).

## 4. Протокол коммуникации и согласования

### 4.1. Замечания и предложения
- Если у агента возникают замечания по спецификации, предложения по улучшению архитектуры или выявляются потенциальные риски:
  1. Агент обязан **немедленно сообщить** об этом пользователю.
  2. Агент **не начинает** реализацию спорного участка кода до получения явного отклика/подтверждения от пользователя.
- Не предполагать молчаливое согласие.

### 4.2. Язык общения
- Код и комментарии внутри файлов: **English**.
- Общение с пользователем (отчеты, вопросы, пояснения): **Русский**, если не указано иное.

## 5. Безопасность и надежность (Базовый уровень)

- **Конфиденциальные данные:** Не хардкодить чувствительные данные (пароли, ключи API, токены). Использовать переменные окружения.
- **Файлы окружения:** Агенту запрещено генерировать файлы `.env` с реальными ключами. Вместо этого должен создаваться файл `.env.example` с заглушками.
- **Обработка ошибок:** Обрабатывать потенциальные ошибки (try/except, error handling) в точках взаимодействия с внешними системами (БД, API, файловая система).
- **Чтение контекста:** Перед внесением изменений в любой существующий файл агент обязан прочитать его актуальное содержимое, чтобы избежать конфликтов или потери логики.

## 6. Обработка ошибок и восстановление

### 6.1. При возникновении ошибок в коде
- Если агент обнаруживает, что написанный код вызывает ошибки при запуске или тестировании:
  1. Немедленно прекратить разработку новых функций.
  2. Сфокусироваться на диагностике и исправлении ошибки.
  3. Предоставить пользователю краткое описание проблемы и предложенное решение.
  4. Не переходить к следующей стадии, пока ошибка не устранена и не подтверждена пользователем.

### 6.2. При потере контекста или неопределенности
- Если агент не уверен в текущем состоянии проекта, структуре файлов или требованиях:
  1. Запросить у пользователя уточнение или повторное предоставление контекста.
  2. Предложить перечитать ключевые файлы (`PROJECT-STRUCTURE.md`, спецификацию) для восстановления понимания.
  3. Не делать предположений, которые могут привести к некорректным изменениям.

## 7. Финальные положения

- Данный документ является живым и может обновляться по взаимному согласию пользователя и агента.
- Любые отклонения от этих требований должны быть явно согласованы перед началом работы.
- При конфликте между требованиями этого документа и разовой инструкцией пользователя, приоритет имеет явная инструкция пользователя, если она не нарушает базовые принципы безопасности.

---
*Document Version: 1.0*  
*Last Updated: 2026*  
*Apply to all AI coding sessions unless explicitly overridden.*